---
published: true
title: How to differentiate between sockets, cores and threads on Solaris
layout: post
tags: [solaris, cpu]
categories: [system]
---
*With solaris zones, a socket can have several cores that can be multithreaded, mpstat will return the number of virtual cpus but it's not clear how the split is done, below are some commands to see the split*

<!--excerpt-->

Let's say we have the following output

<pre style='color:#000000;background:#ffffff;'>mx599zn autoengine ~<span style='color:#40015a; '>/</span>
bash<span style='color:#797997; '>$</span> mpstat
CPU minf mjf xcal  intr ithr  csw icsw migr smtx  srw syscl  usr sys  wt idl
<span style='color:#008c00; '>160</span>    <span style='color:#008c00; '>1</span>   <span style='color:#008c00; '>0</span>    <span style='color:#008c00; '>5</span>    <span style='color:#008c00; '>26</span>    <span style='color:#008c00; '>9</span>   <span style='color:#008c00; '>17</span>    <span style='color:#008c00; '>0</span>    <span style='color:#008c00; '>0</span>    <span style='color:#008c00; '>0</span>    <span style='color:#008c00; '>0</span>    <span style='color:#008c00; '>11</span>    <span style='color:#008c00; '>0</span>   <span style='color:#008c00; '>0</span>   <span style='color:#008c00; '>0</span> <span style='color:#008c00; '>100</span>
<span style='color:#008c00; '>161</span>    <span style='color:#008c00; '>0</span>   <span style='color:#008c00; '>0</span>    <span style='color:#008c00; '>3</span>    <span style='color:#008c00; '>27</span>    <span style='color:#008c00; '>9</span>   <span style='color:#008c00; '>21</span>    <span style='color:#008c00; '>0</span>    <span style='color:#008c00; '>0</span>    <span style='color:#008c00; '>1</span>    <span style='color:#008c00; '>0</span>     <span style='color:#008c00; '>8</span>    <span style='color:#008c00; '>0</span>   <span style='color:#008c00; '>0</span>   <span style='color:#008c00; '>0</span> <span style='color:#008c00; '>100</span>
<span style='color:#008c00; '>162</span>    <span style='color:#008c00; '>0</span>   <span style='color:#008c00; '>0</span>    <span style='color:#008c00; '>3</span>    <span style='color:#008c00; '>29</span>    <span style='color:#008c00; '>9</span>   <span style='color:#008c00; '>24</span>    <span style='color:#008c00; '>0</span>    <span style='color:#008c00; '>0</span>    <span style='color:#008c00; '>1</span>    <span style='color:#008c00; '>0</span>    <span style='color:#008c00; '>10</span>    <span style='color:#008c00; '>0</span>   <span style='color:#008c00; '>0</span>   <span style='color:#008c00; '>0</span> <span style='color:#008c00; '>100</span>
<span style='color:#008c00; '>163</span>    <span style='color:#008c00; '>0</span>   <span style='color:#008c00; '>0</span>    <span style='color:#008c00; '>6</span>    <span style='color:#008c00; '>43</span>   <span style='color:#008c00; '>15</span>   <span style='color:#008c00; '>39</span>    <span style='color:#008c00; '>0</span>    <span style='color:#008c00; '>1</span>    <span style='color:#008c00; '>2</span>    <span style='color:#008c00; '>0</span>    <span style='color:#008c00; '>20</span>    <span style='color:#008c00; '>0</span>   <span style='color:#008c00; '>0</span>   <span style='color:#008c00; '>0</span> <span style='color:#008c00; '>100</span>
<span style='color:#008c00; '>164</span>    <span style='color:#008c00; '>0</span>   <span style='color:#008c00; '>0</span>    <span style='color:#008c00; '>2</span>    <span style='color:#008c00; '>21</span>    <span style='color:#008c00; '>7</span>   <span style='color:#008c00; '>17</span>    <span style='color:#008c00; '>0</span>    <span style='color:#008c00; '>0</span>    <span style='color:#008c00; '>1</span>    <span style='color:#008c00; '>0</span>     <span style='color:#008c00; '>8</span>    <span style='color:#008c00; '>0</span>   <span style='color:#008c00; '>0</span>   <span style='color:#008c00; '>0</span> <span style='color:#008c00; '>100</span>
<span style='color:#008c00; '>165</span>    <span style='color:#008c00; '>0</span>   <span style='color:#008c00; '>0</span>    <span style='color:#008c00; '>2</span>    <span style='color:#008c00; '>22</span>    <span style='color:#008c00; '>8</span>   <span style='color:#008c00; '>16</span>    <span style='color:#008c00; '>0</span>    <span style='color:#008c00; '>0</span>    <span style='color:#008c00; '>0</span>    <span style='color:#008c00; '>0</span>     <span style='color:#008c00; '>7</span>    <span style='color:#008c00; '>0</span>   <span style='color:#008c00; '>0</span>   <span style='color:#008c00; '>0</span> <span style='color:#008c00; '>100</span>
<span style='color:#008c00; '>166</span>    <span style='color:#008c00; '>0</span>   <span style='color:#008c00; '>0</span>    <span style='color:#008c00; '>2</span>    <span style='color:#008c00; '>18</span>    <span style='color:#008c00; '>6</span>   <span style='color:#008c00; '>14</span>    <span style='color:#008c00; '>0</span>    <span style='color:#008c00; '>0</span>    <span style='color:#008c00; '>0</span>    <span style='color:#008c00; '>0</span>     <span style='color:#008c00; '>7</span>    <span style='color:#008c00; '>0</span>   <span style='color:#008c00; '>0</span>   <span style='color:#008c00; '>0</span> <span style='color:#008c00; '>100</span>
<span style='color:#008c00; '>167</span>    <span style='color:#008c00; '>0</span>   <span style='color:#008c00; '>0</span>    <span style='color:#008c00; '>3</span>    <span style='color:#008c00; '>24</span>    <span style='color:#008c00; '>8</span>   <span style='color:#008c00; '>18</span>    <span style='color:#008c00; '>0</span>    <span style='color:#008c00; '>0</span>    <span style='color:#008c00; '>0</span>    <span style='color:#008c00; '>0</span>     <span style='color:#008c00; '>8</span>    <span style='color:#008c00; '>0</span>   <span style='color:#008c00; '>0</span>   <span style='color:#008c00; '>0</span> <span style='color:#008c00; '>100</span>
<span style='color:#008c00; '>168</span>    <span style='color:#008c00; '>0</span>   <span style='color:#008c00; '>0</span>    <span style='color:#008c00; '>2</span>    <span style='color:#008c00; '>21</span>    <span style='color:#008c00; '>7</span>   <span style='color:#008c00; '>17</span>    <span style='color:#008c00; '>0</span>    <span style='color:#008c00; '>0</span>    <span style='color:#008c00; '>0</span>    <span style='color:#008c00; '>0</span>     <span style='color:#008c00; '>7</span>    <span style='color:#008c00; '>0</span>   <span style='color:#008c00; '>0</span>   <span style='color:#008c00; '>0</span> <span style='color:#008c00; '>100</span>
<span style='color:#008c00; '>169</span>    <span style='color:#008c00; '>0</span>   <span style='color:#008c00; '>0</span>    <span style='color:#008c00; '>3</span>    <span style='color:#008c00; '>26</span>    <span style='color:#008c00; '>8</span>   <span style='color:#008c00; '>21</span>    <span style='color:#008c00; '>0</span>    <span style='color:#008c00; '>0</span>    <span style='color:#008c00; '>0</span>    <span style='color:#008c00; '>0</span>     <span style='color:#008c00; '>9</span>    <span style='color:#008c00; '>0</span>   <span style='color:#008c00; '>0</span>   <span style='color:#008c00; '>0</span> <span style='color:#008c00; '>100</span>
<span style='color:#008c00; '>170</span>    <span style='color:#008c00; '>0</span>   <span style='color:#008c00; '>0</span>    <span style='color:#008c00; '>3</span>    <span style='color:#008c00; '>29</span>   <span style='color:#008c00; '>10</span>   <span style='color:#008c00; '>23</span>    <span style='color:#008c00; '>0</span>    <span style='color:#008c00; '>0</span>    <span style='color:#008c00; '>1</span>    <span style='color:#008c00; '>0</span>    <span style='color:#008c00; '>10</span>    <span style='color:#008c00; '>0</span>   <span style='color:#008c00; '>0</span>   <span style='color:#008c00; '>0</span> <span style='color:#008c00; '>100</span>
<span style='color:#008c00; '>171</span>    <span style='color:#008c00; '>0</span>   <span style='color:#008c00; '>0</span>    <span style='color:#008c00; '>6</span>    <span style='color:#008c00; '>42</span>   <span style='color:#008c00; '>14</span>   <span style='color:#008c00; '>39</span>    <span style='color:#008c00; '>0</span>    <span style='color:#008c00; '>1</span>    <span style='color:#008c00; '>2</span>    <span style='color:#008c00; '>0</span>    <span style='color:#008c00; '>20</span>    <span style='color:#008c00; '>0</span>   <span style='color:#008c00; '>0</span>   <span style='color:#008c00; '>0</span> <span style='color:#008c00; '>100</span>
<span style='color:#008c00; '>172</span>    <span style='color:#008c00; '>0</span>   <span style='color:#008c00; '>0</span>    <span style='color:#008c00; '>2</span>    <span style='color:#008c00; '>21</span>    <span style='color:#008c00; '>8</span>   <span style='color:#008c00; '>16</span>    <span style='color:#008c00; '>0</span>    <span style='color:#008c00; '>0</span>    <span style='color:#008c00; '>1</span>    <span style='color:#008c00; '>0</span>     <span style='color:#008c00; '>9</span>    <span style='color:#008c00; '>0</span>   <span style='color:#008c00; '>0</span>   <span style='color:#008c00; '>0</span> <span style='color:#008c00; '>100</span>
<span style='color:#008c00; '>173</span>    <span style='color:#008c00; '>0</span>   <span style='color:#008c00; '>0</span>    <span style='color:#008c00; '>2</span>    <span style='color:#008c00; '>18</span>    <span style='color:#008c00; '>6</span>   <span style='color:#008c00; '>14</span>    <span style='color:#008c00; '>0</span>    <span style='color:#008c00; '>0</span>    <span style='color:#008c00; '>0</span>    <span style='color:#008c00; '>0</span>     <span style='color:#008c00; '>7</span>    <span style='color:#008c00; '>0</span>   <span style='color:#008c00; '>0</span>   <span style='color:#008c00; '>0</span> <span style='color:#008c00; '>100</span>
<span style='color:#008c00; '>174</span>    <span style='color:#008c00; '>0</span>   <span style='color:#008c00; '>0</span>    <span style='color:#008c00; '>1</span>    <span style='color:#008c00; '>17</span>    <span style='color:#008c00; '>6</span>   <span style='color:#008c00; '>13</span>    <span style='color:#008c00; '>0</span>    <span style='color:#008c00; '>0</span>    <span style='color:#008c00; '>0</span>    <span style='color:#008c00; '>0</span>     <span style='color:#008c00; '>6</span>    <span style='color:#008c00; '>0</span>   <span style='color:#008c00; '>0</span>   <span style='color:#008c00; '>0</span> <span style='color:#008c00; '>100</span>
<span style='color:#008c00; '>175</span>    <span style='color:#008c00; '>0</span>   <span style='color:#008c00; '>0</span>    <span style='color:#008c00; '>2</span>    <span style='color:#008c00; '>21</span>    <span style='color:#008c00; '>7</span>   <span style='color:#008c00; '>16</span>    <span style='color:#008c00; '>0</span>    <span style='color:#008c00; '>0</span>    <span style='color:#008c00; '>0</span>    <span style='color:#008c00; '>0</span>     <span style='color:#008c00; '>7</span>    <span style='color:#008c00; '>0</span>   <span style='color:#008c00; '>0</span>   <span style='color:#008c00; '>0</span> <span style='color:#008c00; '>100</span>
<span style='color:#008c00; '>176</span>    <span style='color:#008c00; '>0</span>   <span style='color:#008c00; '>0</span>    <span style='color:#008c00; '>2</span>    <span style='color:#008c00; '>19</span>    <span style='color:#008c00; '>6</span>   <span style='color:#008c00; '>15</span>    <span style='color:#008c00; '>0</span>    <span style='color:#008c00; '>0</span>    <span style='color:#008c00; '>0</span>    <span style='color:#008c00; '>0</span>     <span style='color:#008c00; '>8</span>    <span style='color:#008c00; '>0</span>   <span style='color:#008c00; '>0</span>   <span style='color:#008c00; '>0</span> <span style='color:#008c00; '>100</span>
<span style='color:#008c00; '>177</span>    <span style='color:#008c00; '>0</span>   <span style='color:#008c00; '>0</span>    <span style='color:#008c00; '>3</span>    <span style='color:#008c00; '>24</span>    <span style='color:#008c00; '>8</span>   <span style='color:#008c00; '>19</span>    <span style='color:#008c00; '>0</span>    <span style='color:#008c00; '>0</span>    <span style='color:#008c00; '>0</span>    <span style='color:#008c00; '>0</span>     <span style='color:#008c00; '>8</span>    <span style='color:#008c00; '>0</span>   <span style='color:#008c00; '>0</span>   <span style='color:#008c00; '>0</span> <span style='color:#008c00; '>100</span>
<span style='color:#008c00; '>178</span>    <span style='color:#008c00; '>0</span>   <span style='color:#008c00; '>0</span>    <span style='color:#008c00; '>3</span>    <span style='color:#008c00; '>26</span>   <span style='color:#008c00; '>11</span>   <span style='color:#008c00; '>18</span>    <span style='color:#008c00; '>0</span>    <span style='color:#008c00; '>0</span>    <span style='color:#008c00; '>0</span>    <span style='color:#008c00; '>0</span>     <span style='color:#008c00; '>8</span>    <span style='color:#008c00; '>0</span>   <span style='color:#008c00; '>0</span>   <span style='color:#008c00; '>0</span> <span style='color:#008c00; '>100</span>
<span style='color:#008c00; '>179</span>    <span style='color:#008c00; '>0</span>   <span style='color:#008c00; '>0</span>    <span style='color:#008c00; '>4</span>    <span style='color:#008c00; '>31</span>   <span style='color:#008c00; '>10</span>   <span style='color:#008c00; '>26</span>    <span style='color:#008c00; '>0</span>    <span style='color:#008c00; '>0</span>    <span style='color:#008c00; '>1</span>    <span style='color:#008c00; '>0</span>    <span style='color:#008c00; '>11</span>    <span style='color:#008c00; '>0</span>   <span style='color:#008c00; '>0</span>   <span style='color:#008c00; '>0</span> <span style='color:#008c00; '>100</span>
<span style='color:#008c00; '>180</span>    <span style='color:#008c00; '>0</span>   <span style='color:#008c00; '>0</span>    <span style='color:#008c00; '>6</span>    <span style='color:#008c00; '>42</span>   <span style='color:#008c00; '>16</span>   <span style='color:#008c00; '>36</span>    <span style='color:#008c00; '>0</span>    <span style='color:#008c00; '>1</span>    <span style='color:#008c00; '>2</span>    <span style='color:#008c00; '>0</span>    <span style='color:#008c00; '>19</span>    <span style='color:#008c00; '>0</span>   <span style='color:#008c00; '>0</span>   <span style='color:#008c00; '>0</span> <span style='color:#008c00; '>100</span>
<span style='color:#008c00; '>181</span>    <span style='color:#008c00; '>0</span>   <span style='color:#008c00; '>0</span>    <span style='color:#008c00; '>3</span>    <span style='color:#008c00; '>24</span>    <span style='color:#008c00; '>8</span>   <span style='color:#008c00; '>19</span>    <span style='color:#008c00; '>0</span>    <span style='color:#008c00; '>0</span>    <span style='color:#008c00; '>1</span>    <span style='color:#008c00; '>0</span>     <span style='color:#008c00; '>9</span>    <span style='color:#008c00; '>0</span>   <span style='color:#008c00; '>0</span>   <span style='color:#008c00; '>0</span> <span style='color:#008c00; '>100</span>
<span style='color:#008c00; '>182</span>    <span style='color:#008c00; '>0</span>   <span style='color:#008c00; '>0</span>    <span style='color:#008c00; '>2</span>    <span style='color:#008c00; '>17</span>    <span style='color:#008c00; '>6</span>   <span style='color:#008c00; '>13</span>    <span style='color:#008c00; '>0</span>    <span style='color:#008c00; '>0</span>    <span style='color:#008c00; '>0</span>    <span style='color:#008c00; '>0</span>     <span style='color:#008c00; '>7</span>    <span style='color:#008c00; '>0</span>   <span style='color:#008c00; '>0</span>   <span style='color:#008c00; '>0</span> <span style='color:#008c00; '>100</span>
<span style='color:#008c00; '>183</span>    <span style='color:#008c00; '>0</span>   <span style='color:#008c00; '>0</span>    <span style='color:#008c00; '>2</span>    <span style='color:#008c00; '>21</span>    <span style='color:#008c00; '>7</span>   <span style='color:#008c00; '>16</span>    <span style='color:#008c00; '>0</span>    <span style='color:#008c00; '>0</span>    <span style='color:#008c00; '>0</span>    <span style='color:#008c00; '>0</span>     <span style='color:#008c00; '>7</span>    <span style='color:#008c00; '>0</span>   <span style='color:#008c00; '>0</span>   <span style='color:#008c00; '>0</span> <span style='color:#008c00; '>100</span>
<span style='color:#008c00; '>184</span>    <span style='color:#008c00; '>0</span>   <span style='color:#008c00; '>0</span>    <span style='color:#008c00; '>2</span>    <span style='color:#008c00; '>19</span>    <span style='color:#008c00; '>6</span>   <span style='color:#008c00; '>15</span>    <span style='color:#008c00; '>0</span>    <span style='color:#008c00; '>0</span>    <span style='color:#008c00; '>0</span>    <span style='color:#008c00; '>0</span>     <span style='color:#008c00; '>7</span>    <span style='color:#008c00; '>0</span>   <span style='color:#008c00; '>0</span>   <span style='color:#008c00; '>0</span> <span style='color:#008c00; '>100</span>
<span style='color:#008c00; '>185</span>    <span style='color:#008c00; '>0</span>   <span style='color:#008c00; '>0</span>    <span style='color:#008c00; '>3</span>    <span style='color:#008c00; '>23</span>    <span style='color:#008c00; '>7</span>   <span style='color:#008c00; '>18</span>    <span style='color:#008c00; '>0</span>    <span style='color:#008c00; '>0</span>    <span style='color:#008c00; '>0</span>    <span style='color:#008c00; '>0</span>     <span style='color:#008c00; '>8</span>    <span style='color:#008c00; '>0</span>   <span style='color:#008c00; '>0</span>   <span style='color:#008c00; '>0</span> <span style='color:#008c00; '>100</span>
<span style='color:#008c00; '>186</span>    <span style='color:#008c00; '>0</span>   <span style='color:#008c00; '>0</span>    <span style='color:#008c00; '>2</span>    <span style='color:#008c00; '>22</span>    <span style='color:#008c00; '>7</span>   <span style='color:#008c00; '>18</span>    <span style='color:#008c00; '>0</span>    <span style='color:#008c00; '>0</span>    <span style='color:#008c00; '>0</span>    <span style='color:#008c00; '>0</span>     <span style='color:#008c00; '>8</span>    <span style='color:#008c00; '>0</span>   <span style='color:#008c00; '>0</span>   <span style='color:#008c00; '>0</span> <span style='color:#008c00; '>100</span>
<span style='color:#008c00; '>187</span>    <span style='color:#008c00; '>0</span>   <span style='color:#008c00; '>0</span>    <span style='color:#008c00; '>4</span>    <span style='color:#008c00; '>31</span>   <span style='color:#008c00; '>10</span>   <span style='color:#008c00; '>25</span>    <span style='color:#008c00; '>0</span>    <span style='color:#008c00; '>0</span>    <span style='color:#008c00; '>1</span>    <span style='color:#008c00; '>0</span>    <span style='color:#008c00; '>11</span>    <span style='color:#008c00; '>0</span>   <span style='color:#008c00; '>0</span>   <span style='color:#008c00; '>0</span> <span style='color:#008c00; '>100</span>
<span style='color:#008c00; '>188</span>    <span style='color:#008c00; '>0</span>   <span style='color:#008c00; '>0</span>    <span style='color:#008c00; '>6</span>    <span style='color:#008c00; '>38</span>   <span style='color:#008c00; '>13</span>   <span style='color:#008c00; '>36</span>    <span style='color:#008c00; '>0</span>    <span style='color:#008c00; '>1</span>    <span style='color:#008c00; '>2</span>    <span style='color:#008c00; '>0</span>    <span style='color:#008c00; '>18</span>    <span style='color:#008c00; '>0</span>   <span style='color:#008c00; '>0</span>   <span style='color:#008c00; '>0</span> <span style='color:#008c00; '>100</span>
<span style='color:#008c00; '>189</span>    <span style='color:#008c00; '>0</span>   <span style='color:#008c00; '>0</span>    <span style='color:#008c00; '>3</span>    <span style='color:#008c00; '>23</span>    <span style='color:#008c00; '>7</span>   <span style='color:#008c00; '>19</span>    <span style='color:#008c00; '>0</span>    <span style='color:#008c00; '>0</span>    <span style='color:#008c00; '>1</span>    <span style='color:#008c00; '>0</span>     <span style='color:#008c00; '>9</span>    <span style='color:#008c00; '>0</span>   <span style='color:#008c00; '>0</span>   <span style='color:#008c00; '>0</span> <span style='color:#008c00; '>100</span>
<span style='color:#008c00; '>190</span>    <span style='color:#008c00; '>0</span>   <span style='color:#008c00; '>0</span>    <span style='color:#008c00; '>1</span>    <span style='color:#008c00; '>16</span>    <span style='color:#008c00; '>5</span>   <span style='color:#008c00; '>12</span>    <span style='color:#008c00; '>0</span>    <span style='color:#008c00; '>0</span>    <span style='color:#008c00; '>0</span>    <span style='color:#008c00; '>0</span>     <span style='color:#008c00; '>6</span>    <span style='color:#008c00; '>0</span>   <span style='color:#008c00; '>0</span>   <span style='color:#008c00; '>0</span> <span style='color:#008c00; '>100</span>
<span style='color:#008c00; '>191</span>    <span style='color:#008c00; '>0</span>   <span style='color:#008c00; '>0</span>    <span style='color:#008c00; '>2</span>    <span style='color:#008c00; '>20</span>    <span style='color:#008c00; '>7</span>   <span style='color:#008c00; '>15</span>    <span style='color:#008c00; '>0</span>    <span style='color:#008c00; '>0</span>    <span style='color:#008c00; '>0</span>    <span style='color:#008c00; '>0</span>     <span style='color:#008c00; '>8</span>    <span style='color:#008c00; '>0</span>   <span style='color:#008c00; '>0</span>   <span style='color:#008c00; '>0</span> <span style='color:#008c00; '>100</span>
</pre>
<br/>

cool, I have 32 CPUs but is it real CPUS or threads?

Use the command belows to distinguish between sockets, cores and threads

<pre style='color:#000000;background:#ffffff;'>mx599zn autoengine ~<span style='color:#40015a; '>/</span>
bash<span style='color:#797997; '>$</span> kstat cpu_info <span style='color:#e34adc; '>|</span> grep chip_id <span style='color:#e34adc; '>|</span> awk <span style='color:#0000e6; '>'{ print $2 }'</span> <span style='color:#e34adc; '>|</span> sort <span style='color:#44aadd; '>-u</span> <span style='color:#e34adc; '>|</span> wc -l
       <span style='color:#008c00; '>1</span>
mx599zn autoengine ~<span style='color:#40015a; '>/</span>
bash<span style='color:#797997; '>$</span> kstat cpu_info <span style='color:#e34adc; '>|</span> grep core_id <span style='color:#e34adc; '>|</span> awk <span style='color:#0000e6; '>'{ print $2 }'</span> <span style='color:#e34adc; '>|</span> sort <span style='color:#44aadd; '>-u</span> <span style='color:#e34adc; '>|</span> wc -l
       <span style='color:#008c00; '>4</span>
mx599zn autoengine ~<span style='color:#40015a; '>/</span>
bash<span style='color:#797997; '>$</span> kstat cpu_info <span style='color:#e34adc; '>|</span> <span style='color:#bb7977; font-weight:bold; '>grep</span><span style='color:#0000e6; '> </span><span style='color:#800000; '>'</span><span style='color:#0000e6; '>module: cpu_info</span><span style='color:#800000; '>'</span> <span style='color:#e34adc; '>|</span> awk <span style='color:#0000e6; '>'{ print $4 }'</span> <span style='color:#e34adc; '>|</span> sort <span style='color:#44aadd; '>-u</span> <span style='color:#e34adc; '>|</span> wc -l
      <span style='color:#008c00; '>32</span>
mx599zn autoengine ~
</pre>
<br/>

Below is a better script displaying the following output

~~~
bash$ ./showcores.sh
Total number of physical processors: 1
Number of virtual processors: 32
Total number of cores: 4
Number of cores per physical processor: 4
Number of hardware threads (strands or vCPUs) per core: 8
Processor speed: 3600 MHz (3.60 GHz)

** Socket-Core-vCPU mapping **

Physical Processor 1 (chip id: 1):
        Core 1 (core id: 3134):
                vCPU ids: 160 - 167
        Core 2 (core id: 3137):
                vCPU ids: 168 - 175
        Core 3 (core id: 3140):
                vCPU ids: 176 - 183
        Core 4 (core id: 3143):
                vCPU ids: 184 - 191

~~~

<pre style='color:#000000;background:#ffffff;'><span style='color:#696969; '>#!</span><span style='color:#007997; '>/bin/bash</span>

<span style='color:#40015a; '>/usr/bin/kstat</span> -m cpu_info <span style='color:#e34adc; '>|</span> egrep <span style='color:#0000e6; '>"chip_id|core_id|module: cpu_info"</span> <span style='color:#e34adc; '>></span> <span style='color:#40015a; '>/var/tmp/cpu_info.log</span>

<span style='color:#797997; '>nproc</span><span style='color:#808030; '>=</span><span style='color:#000000; background:#ffffe8; '>`</span><span style='color:#800080; background:#ffffe8; '>(</span><span style='color:#000000; background:#ffffe8; '>grep chip_id </span><span style='color:#40015a; background:#ffffe8; '>/var/tmp/cpu_info.log</span><span style='color:#000000; background:#ffffe8; '> </span><span style='color:#e34adc; background:#ffffe8; '>|</span><span style='color:#000000; background:#ffffe8; '> awk </span><span style='color:#0000e6; background:#ffffe8; '>'{ print $2 }'</span><span style='color:#000000; background:#ffffe8; '> </span><span style='color:#e34adc; background:#ffffe8; '>|</span><span style='color:#000000; background:#ffffe8; '> sort </span><span style='color:#44aadd; background:#ffffe8; '>-u</span><span style='color:#000000; background:#ffffe8; '> </span><span style='color:#e34adc; background:#ffffe8; '>|</span><span style='color:#000000; background:#ffffe8; '> wc -l </span><span style='color:#e34adc; background:#ffffe8; '>|</span><span style='color:#000000; background:#ffffe8; '> tr </span><span style='color:#44aadd; background:#ffffe8; '>-d</span><span style='color:#000000; background:#ffffe8; '> </span><span style='color:#0000e6; background:#ffffe8; '>' '</span><span style='color:#800080; background:#ffffe8; '>)</span><span style='color:#000000; background:#ffffe8; '>`</span>
<span style='color:#797997; '>ncore</span><span style='color:#808030; '>=</span><span style='color:#000000; background:#ffffe8; '>`</span><span style='color:#800080; background:#ffffe8; '>(</span><span style='color:#000000; background:#ffffe8; '>grep core_id </span><span style='color:#40015a; background:#ffffe8; '>/var/tmp/cpu_info.log</span><span style='color:#000000; background:#ffffe8; '> </span><span style='color:#e34adc; background:#ffffe8; '>|</span><span style='color:#000000; background:#ffffe8; '> awk </span><span style='color:#0000e6; background:#ffffe8; '>'{ print $2 }'</span><span style='color:#000000; background:#ffffe8; '> </span><span style='color:#e34adc; background:#ffffe8; '>|</span><span style='color:#000000; background:#ffffe8; '> sort </span><span style='color:#44aadd; background:#ffffe8; '>-u</span><span style='color:#000000; background:#ffffe8; '> </span><span style='color:#e34adc; background:#ffffe8; '>|</span><span style='color:#000000; background:#ffffe8; '> wc -l </span><span style='color:#e34adc; background:#ffffe8; '>|</span><span style='color:#000000; background:#ffffe8; '> tr </span><span style='color:#44aadd; background:#ffffe8; '>-d</span><span style='color:#000000; background:#ffffe8; '> </span><span style='color:#0000e6; background:#ffffe8; '>' '</span><span style='color:#800080; background:#ffffe8; '>)</span><span style='color:#000000; background:#ffffe8; '>`</span>
<span style='color:#797997; '>vproc</span><span style='color:#808030; '>=</span><span style='color:#000000; background:#ffffe8; '>`</span><span style='color:#800080; background:#ffffe8; '>(</span><span style='color:#bb7977; background:#ffffe8; font-weight:bold; '>grep</span><span style='color:#0000e6; background:#ffffe8; '> </span><span style='color:#800000; background:#ffffe8; '>'</span><span style='color:#0000e6; background:#ffffe8; '>module: cpu_info</span><span style='color:#800000; background:#ffffe8; '>'</span><span style='color:#000000; background:#ffffe8; '> </span><span style='color:#40015a; background:#ffffe8; '>/var/tmp/cpu_info.log</span><span style='color:#000000; background:#ffffe8; '> </span><span style='color:#e34adc; background:#ffffe8; '>|</span><span style='color:#000000; background:#ffffe8; '> awk </span><span style='color:#0000e6; background:#ffffe8; '>'{ print $4 }'</span><span style='color:#000000; background:#ffffe8; '> </span><span style='color:#e34adc; background:#ffffe8; '>|</span><span style='color:#000000; background:#ffffe8; '> sort </span><span style='color:#44aadd; background:#ffffe8; '>-u</span><span style='color:#000000; background:#ffffe8; '> </span><span style='color:#e34adc; background:#ffffe8; '>|</span><span style='color:#000000; background:#ffffe8; '> wc -l </span><span style='color:#e34adc; background:#ffffe8; '>|</span><span style='color:#000000; background:#ffffe8; '> tr </span><span style='color:#44aadd; background:#ffffe8; '>-d</span><span style='color:#000000; background:#ffffe8; '> </span><span style='color:#0000e6; background:#ffffe8; '>' '</span><span style='color:#800080; background:#ffffe8; '>)</span><span style='color:#000000; background:#ffffe8; '>`</span>

<span style='color:#797997; '>nstrandspercore</span><span style='color:#808030; '>=</span>$<span style='color:#800080; '>(</span><span style='color:#800080; '>(</span><span style='color:#797997; '>$vproc</span><span style='color:#40015a; '>/</span><span style='color:#797997; '>$ncore</span><span style='color:#800080; '>)</span><span style='color:#800080; '>)</span>
<span style='color:#797997; '>ncoresperproc</span><span style='color:#808030; '>=</span>$<span style='color:#800080; '>(</span><span style='color:#800080; '>(</span><span style='color:#797997; '>$ncore</span><span style='color:#40015a; '>/</span><span style='color:#797997; '>$nproc</span><span style='color:#800080; '>)</span><span style='color:#800080; '>)</span>

<span style='color:#797997; '>speedinmhz</span><span style='color:#808030; '>=</span><span style='color:#000000; background:#ffffe8; '>`</span><span style='color:#800080; background:#ffffe8; '>(</span><span style='color:#40015a; background:#ffffe8; '>/usr/bin/kstat</span><span style='color:#000000; background:#ffffe8; '> -m cpu_info </span><span style='color:#e34adc; background:#ffffe8; '>|</span><span style='color:#000000; background:#ffffe8; '> grep clock_MHz </span><span style='color:#e34adc; background:#ffffe8; '>|</span><span style='color:#000000; background:#ffffe8; '> awk </span><span style='color:#0000e6; background:#ffffe8; '>'{ print $2 }'</span><span style='color:#000000; background:#ffffe8; '> </span><span style='color:#e34adc; background:#ffffe8; '>|</span><span style='color:#000000; background:#ffffe8; '> sort </span><span style='color:#44aadd; background:#ffffe8; '>-u</span><span style='color:#800080; background:#ffffe8; '>)</span><span style='color:#000000; background:#ffffe8; '>`</span>
<span style='color:#797997; '>speedinghz</span><span style='color:#808030; '>=</span><span style='color:#000000; background:#ffffe8; '>`</span><span style='color:#bb7977; background:#ffffe8; font-weight:bold; '>echo</span><span style='color:#000000; background:#ffffe8; '> </span><span style='color:#0000e6; background:#ffffe8; '>"</span><span style='color:#797997; background:#ffffe8; '>scale</span><span style='color:#808030; background:#ffffe8; '>=</span><span style='color:#0000e6; background:#ffffe8; '>2; </span><span style='color:#797997; background:#ffffe8; '>$speedinmhz</span><span style='color:#40015a; background:#ffffe8; '>/1000</span><span style='color:#0000e6; background:#ffffe8; '>"</span><span style='color:#000000; background:#ffffe8; '> </span><span style='color:#e34adc; background:#ffffe8; '>|</span><span style='color:#000000; background:#ffffe8; '> bc`</span>

<span style='color:#bb7977; font-weight:bold; '>echo</span> <span style='color:#0000e6; '>"Total number of physical processors: </span><span style='color:#797997; '>$nproc</span><span style='color:#0000e6; '>"</span>
<span style='color:#bb7977; font-weight:bold; '>echo</span> <span style='color:#0000e6; '>"Number of virtual processors: </span><span style='color:#797997; '>$vproc</span><span style='color:#0000e6; '>"</span>
<span style='color:#bb7977; font-weight:bold; '>echo</span> <span style='color:#0000e6; '>"Total number of cores: </span><span style='color:#797997; '>$ncore</span><span style='color:#0000e6; '>"</span>
<span style='color:#bb7977; font-weight:bold; '>echo</span> <span style='color:#0000e6; '>"Number of cores per physical processor: </span><span style='color:#797997; '>$ncoresperproc</span><span style='color:#0000e6; '>"</span>
<span style='color:#bb7977; font-weight:bold; '>echo</span> <span style='color:#0000e6; '>"Number of hardware threads (strands or vCPUs) per core: </span><span style='color:#797997; '>$nstrandspercore</span><span style='color:#0000e6; '>"</span>
<span style='color:#bb7977; font-weight:bold; '>echo</span> <span style='color:#0000e6; '>"Processor speed: </span><span style='color:#797997; '>$speedinmhz</span><span style='color:#0000e6; '> MHz (</span><span style='color:#797997; '>$speedinghz</span><span style='color:#0000e6; '> GHz)"</span>

<span style='color:#696969; '># now derive the vcpu-to-core mapping based on above information #</span>

<span style='color:#bb7977; font-weight:bold; '>echo</span> <span style='color:#44aadd; '>-e</span> <span style='color:#0000e6; '>"</span><span style='color:#0f69ff; '>\n</span><span style='color:#0000e6; '>** Socket-Core-vCPU mapping **"</span>
<span style='color:#bb7977; font-weight:bold; '>let</span> <span style='color:#797997; '>linenum</span><span style='color:#808030; '>=</span><span style='color:#008c00; '>2</span>

<span style='color:#800000; font-weight:bold; '>for</span> <span style='color:#800080; '>(</span><span style='color:#800080; '>(</span>i <span style='color:#44aadd; '>=</span> <span style='color:#008c00; '>1</span><span style='color:#800080; '>;</span> i <span style='color:#e34adc; '>&lt;</span>= <span style='color:#797997; '>${</span>nproc<span style='color:#797997; '>}</span><span style='color:#800080; '>;</span> ++i <span style='color:#800080; '>)</span><span style='color:#800080; '>)</span>
<span style='color:#800000; font-weight:bold; '>do</span>
        <span style='color:#797997; '>chipid</span><span style='color:#808030; '>=</span><span style='color:#000000; background:#ffffe8; '>`</span><span style='color:#bb7977; background:#ffffe8; font-weight:bold; '>sed</span><span style='color:#000000; background:#ffffe8; '> </span><span style='color:#44aadd; background:#ffffe8; '>-n</span><span style='color:#000000; background:#ffffe8; '> </span><span style='color:#797997; background:#ffffe8; '>${</span><span style='color:#000000; background:#ffffe8; '>linenum</span><span style='color:#797997; background:#ffffe8; '>}</span><span style='color:#000000; background:#ffffe8; '>p </span><span style='color:#40015a; background:#ffffe8; '>/var/tmp/cpu_info.log</span><span style='color:#000000; background:#ffffe8; '> </span><span style='color:#e34adc; background:#ffffe8; '>|</span><span style='color:#000000; background:#ffffe8; '> awk </span><span style='color:#0000e6; background:#ffffe8; '>'{ print $2 }'</span><span style='color:#000000; background:#ffffe8; '>`</span>
        <span style='color:#bb7977; font-weight:bold; '>echo</span> <span style='color:#44aadd; '>-e</span> <span style='color:#0000e6; '>"</span><span style='color:#0f69ff; '>\n</span><span style='color:#0000e6; '>Physical Processor </span><span style='color:#797997; '>$i</span><span style='color:#0000e6; '> (chip id: </span><span style='color:#797997; '>$chipid</span><span style='color:#0000e6; '>):"</span>

        <span style='color:#800000; font-weight:bold; '>for</span> <span style='color:#800080; '>(</span><span style='color:#800080; '>(</span>j <span style='color:#44aadd; '>=</span> <span style='color:#008c00; '>1</span><span style='color:#800080; '>;</span> j <span style='color:#e34adc; '>&lt;</span>= <span style='color:#797997; '>${</span>ncoresperproc<span style='color:#797997; '>}</span><span style='color:#800080; '>;</span> ++j <span style='color:#800080; '>)</span><span style='color:#800080; '>)</span>
        <span style='color:#800000; font-weight:bold; '>do</span>
                <span style='color:#bb7977; font-weight:bold; '>let</span> <span style='color:#797997; '>linenum</span><span style='color:#808030; '>=</span><span style='color:#800080; '>(</span><span style='color:#797997; '>$linenum</span> + <span style='color:#008c00; '>1</span><span style='color:#800080; '>)</span>
                <span style='color:#797997; '>coreid</span><span style='color:#808030; '>=</span><span style='color:#000000; background:#ffffe8; '>`</span><span style='color:#bb7977; background:#ffffe8; font-weight:bold; '>sed</span><span style='color:#000000; background:#ffffe8; '> </span><span style='color:#44aadd; background:#ffffe8; '>-n</span><span style='color:#000000; background:#ffffe8; '> </span><span style='color:#797997; background:#ffffe8; '>${</span><span style='color:#000000; background:#ffffe8; '>linenum</span><span style='color:#797997; background:#ffffe8; '>}</span><span style='color:#000000; background:#ffffe8; '>p </span><span style='color:#40015a; background:#ffffe8; '>/var/tmp/cpu_info.log</span><span style='color:#000000; background:#ffffe8; '> </span><span style='color:#e34adc; background:#ffffe8; '>|</span><span style='color:#000000; background:#ffffe8; '> awk </span><span style='color:#0000e6; background:#ffffe8; '>'{ print $2 }'</span><span style='color:#000000; background:#ffffe8; '>`</span>
                <span style='color:#bb7977; font-weight:bold; '>echo</span> <span style='color:#44aadd; '>-e</span> <span style='color:#0000e6; '>"</span><span style='color:#0f69ff; '>\t</span><span style='color:#0000e6; '>Core </span><span style='color:#797997; '>$j</span><span style='color:#0000e6; '> (core id: </span><span style='color:#797997; '>$coreid</span><span style='color:#0000e6; '>):"</span>

                <span style='color:#bb7977; font-weight:bold; '>let</span> <span style='color:#797997; '>linenum</span><span style='color:#808030; '>=</span><span style='color:#800080; '>(</span><span style='color:#797997; '>$linenum</span> - <span style='color:#008c00; '>2</span><span style='color:#800080; '>)</span>
                <span style='color:#797997; '>vcpustart</span><span style='color:#808030; '>=</span><span style='color:#000000; background:#ffffe8; '>`</span><span style='color:#bb7977; background:#ffffe8; font-weight:bold; '>sed</span><span style='color:#000000; background:#ffffe8; '> </span><span style='color:#44aadd; background:#ffffe8; '>-n</span><span style='color:#000000; background:#ffffe8; '> </span><span style='color:#797997; background:#ffffe8; '>${</span><span style='color:#000000; background:#ffffe8; '>linenum</span><span style='color:#797997; background:#ffffe8; '>}</span><span style='color:#000000; background:#ffffe8; '>p </span><span style='color:#40015a; background:#ffffe8; '>/var/tmp/cpu_info.log</span><span style='color:#000000; background:#ffffe8; '> </span><span style='color:#e34adc; background:#ffffe8; '>|</span><span style='color:#000000; background:#ffffe8; '> awk </span><span style='color:#0000e6; background:#ffffe8; '>'{ print $4 }'</span><span style='color:#000000; background:#ffffe8; '>`</span>

                <span style='color:#bb7977; font-weight:bold; '>let</span> <span style='color:#797997; '>linenum</span><span style='color:#808030; '>=</span><span style='color:#800080; '>(</span><span style='color:#008c00; '>3</span> <span style='color:#808030; '>*</span> <span style='color:#797997; '>$nstrandspercore</span> + <span style='color:#797997; '>$linenum</span> - <span style='color:#008c00; '>3</span><span style='color:#800080; '>)</span>
                <span style='color:#797997; '>vcpuend</span><span style='color:#808030; '>=</span><span style='color:#000000; background:#ffffe8; '>`</span><span style='color:#bb7977; background:#ffffe8; font-weight:bold; '>sed</span><span style='color:#000000; background:#ffffe8; '> </span><span style='color:#44aadd; background:#ffffe8; '>-n</span><span style='color:#000000; background:#ffffe8; '> </span><span style='color:#797997; background:#ffffe8; '>${</span><span style='color:#000000; background:#ffffe8; '>linenum</span><span style='color:#797997; background:#ffffe8; '>}</span><span style='color:#000000; background:#ffffe8; '>p </span><span style='color:#40015a; background:#ffffe8; '>/var/tmp/cpu_info.log</span><span style='color:#000000; background:#ffffe8; '> </span><span style='color:#e34adc; background:#ffffe8; '>|</span><span style='color:#000000; background:#ffffe8; '> awk </span><span style='color:#0000e6; background:#ffffe8; '>'{ print $4 }'</span><span style='color:#000000; background:#ffffe8; '>`</span>

                <span style='color:#bb7977; font-weight:bold; '>echo</span> <span style='color:#44aadd; '>-e</span> <span style='color:#0000e6; '>"</span><span style='color:#0f69ff; '>\t</span><span style='color:#0f69ff; '>\t</span><span style='color:#0000e6; '>vCPU ids: </span><span style='color:#797997; '>$vcpustart</span><span style='color:#0000e6; '> - </span><span style='color:#797997; '>$vcpuend</span><span style='color:#0000e6; '>"</span>
                <span style='color:#bb7977; font-weight:bold; '>let</span> <span style='color:#797997; '>linenum</span><span style='color:#808030; '>=</span><span style='color:#800080; '>(</span><span style='color:#797997; '>$linenum</span> + <span style='color:#008c00; '>4</span><span style='color:#800080; '>)</span>
        <span style='color:#800000; font-weight:bold; '>done</span>
<span style='color:#800000; font-weight:bold; '>done</span>

rm <span style='color:#40015a; '>/var/tmp/cpu_info.log</span>
</pre>
<br/>